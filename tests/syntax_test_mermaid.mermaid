%% SYNTAX TEST "Packages/Mermaid/mermaid.sublime-syntax"

%% Example code
%% <- punctuation.definition.comment.mermaid
%% ^^^^^^^^^^^^^ comment.line.percentage.mermaid

graph TB %% tab completion: 'graph'
%% <- meta.declaration.graph.mermaid
%%  ^ keyword.type.graph.mermaid
%%    ^ constant.type.graph.mermaid
%%       ^ punctuation.definition.comment.mermaid
  ID-1[Node 1] %% tab completion: 'node'
%% <- meta.declaration.node.graph.mermaid
%%   ^ entity.name.node.graph.mermaid
%%    ^ keyword.operator.begin.node.graph.mermaid
%%     ^ string.text.node.graph.mermaid
%%           ^ keyword.operator.end.node.graph.mermaid
%%             ^ punctuation.definition.comment.mermaid
  ID-2>Node 2]
  ID-3(Node 3)
  ID-1---ID-2 %% tab completion: 'link'
%% ^ meta.declaration.link.graph.mermaid
%%    ^^^ keyword.operator.link.graph.mermaid
%%            ^ punctuation.definition.comment.mermaid
  ID-1 --> ID-3 %% tab completion: 'link'
%% ^ meta.declaration.link.graph.mermaid
%%     ^^^ keyword.operator.link.graph.mermaid
%%              ^ punctuation.definition.comment.mermaid
  ID-2--Link between 2 and 3---ID-3 %% tab completion: 'link'
%% ^ meta.declaration.link.graph.mermaid
%%    ^^ keyword.operator.link.graph.mermaid
%%      ^ string.text.link.graph.mermaid
%%                          ^^^ keyword.operator.link.graph.mermaid
%%                                  ^ punctuation.definition.comment.mermaid
  ID-1-->|Action from 1 to 3|ID-3 %% tab completion: 'link'
%% ^ meta.declaration.link.graph.mermaid
%%    ^^^ keyword.operator.link.graph.mermaid
%%       ^ keyword.operator.begin.text.link.graph.mermaid
%%        ^ string.text.link.graph.mermaid
%%                          ^ keyword.operator.end.text.link.graph.mermaid
%%                                ^ punctuation.definition.comment.mermaid
  ID-3 -- Action from 3 to 2 --> ID-2 %% tab completion: 'link'
%% ^ meta.declaration.link.graph.mermaid
%%     ^^ keyword.operator.link.graph.mermaid
%%        ^ string.text.link.graph.mermaid
%%                           ^^^ keyword.operator.link.graph.mermaid
%%                                    ^ punctuation.definition.comment.mermaid
  classDef blue fill:#08f,stroke:#fff %% tab completion: 'class'
%% <- meta.declaration.styling.graph.mermaid
%% ^ keyword.type.styling.graph.mermaid
%%         ^ entity.name.styling.graph.mermaid
%%              ^ string.text.styling.graph.mermaid
%%                                    ^ punctuation.definition.comment.mermaid
  class ID-1 blue %% tab completion: 'class'
%% <- meta.declaration.styling.graph.mermaid
%% ^ keyword.type.styling.graph.mermaid
%%           ^ support.name.styling.graph.mermaid
%%                ^ punctuation.definition.comment.mermaid
  click ID-1 "https://github.com" "Tooltip text" %% tab completion: 'click'
%% <- meta.declaration.interaction.graph.mermaid
%% ^ keyword.type.interaction.graph.mermaid
%%           ^ punctuation.definition.string.begin.mermaid
%%            ^ string.quoted.double.mermaid
%%                              ^ punctuation.definition.string.end.mermaid
%%                                ^ punctuation.definition.string.begin.mermaid
%%                                 ^ string.quoted.double.mermaid
%%                                             ^ punctuation.definition.string.end.mermaid
%%                                               ^ punctuation.definition.comment.mermaid
  click ID-1 alert "Tooltip for a callback" %% tab completion: 'click'
%%           ^ entity.name.callback.interaction.graph.mermaid
  subgraph A subgraph
%% <- meta.declaration.sub.graph.mermaid
%% ^ keyword.type.begin.sub.graph.mermaid
%%         ^ string.text.sub.graph.mermaid
    ID-4{Node 4}
    ID-5((fa:fa-spinner))
    ID-6["Node 6 (same #quot;shape#quot;)"]
    ID-4-.->ID-5
%%      ^^^^ keyword.operator.link.graph.mermaid
    ID-5 -. Action from 5 to 4 .-> ID-4
%%       ^^ keyword.operator.link.graph.mermaid
%%                             ^^^ keyword.operator.link.graph.mermaid
    ID-5==>ID-6
%%      ^^^ keyword.operator.link.graph.mermaid
    ID-6 == Action from 6 to 5 ==> ID-5
%%       ^^ keyword.operator.link.graph.mermaid
%%                             ^^^ keyword.operator.link.graph.mermaid
%%  ^ meta.declaration.sub.graph.mermaid
  end %% tab completion: 'subgraph'
%% <- meta.declaration.sub.graph.mermaid
%% ^ keyword.type.end.sub.graph.mermaid
%%    ^ punctuation.definition.comment.mermaid

sequenceDiagram
%% <- meta.declaration.diagram.mermaid
%% ^^^^^^^^^^^^ meta.declaration.diagram.mermaid keyword.declaration.trait.diagram.mermaid

  autonumber
%% ^^^^^^^^^ keyword.other.mermaid

  participant A as Alice
%% <- meta.declaration.actor.diagram.mermaid
%% ^^^^^^^^^^ storage.type.interface.mermaid
%%            ^ entity.name.actor.diagram.mermaid
%%              ^^ keyword.context.resource.mermaid
%%                 ^^^^^ string.unquoted.alias.actor.diagram.mermaid
  participant B as Bob
  participant C as Carol
  participant NoAlias
%% ^^^^^^^^^^^^^^^^^^ meta.declaration.actor.diagram
%% ^^^^^^^^^^ storage.type.interface
%%            ^^^^^^^ entity.name.actor.diagram
%%                   ^ - entity - invalid - meta.declaration.actor
  Note left of A: Alice likes to chat
%% <- meta.declaration.note.diagram.mermaid
%% ^ keyword.type.note.diagram.mermaid
%%     ^^^^^^^ constant.language.note.diagram.mermaid
%%              ^ punctuation.separator.key-value.mermaid
%%                ^^^^^^^^^^^^^^^^^^^ meta.declaration.note.diagram.mermaid
  A->B: Hello Bob, how are you?
%%^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ meta.declaration.message.diagram.mermaid
%% ^^ keyword.operator.message.diagram.mermaid
%%    ^ punctuation.separator.key-value.mermaid
%%      ^^^^^^^^^^^^^^^^^^^^^^^ text.html.basic
  loop Healthcheck
%% <- meta.declaration.loop.diagram.mermaid
%% ^ keyword.type.begin.loop.diagram.mermaid
%%     ^ string.text.loop.diagram.mermaid
    B->B: Bob checks himself...
%% <- meta.declaration.message.diagram.mermaid
%%   ^^ keyword.operator.message.diagram.mermaid
%%      ^ punctuation.separator.key-value.mermaid
%%        ^^^^^^^^^^^^^^^^^^^^^ text.html.basic
  end
%% <- meta.declaration.loop.diagram.mermaid
%% ^ keyword.type.end.loop.diagram.mermaid
  Note over B: Bob whispers when sick
  alt is sick
%% <- meta.declaration.alternative-path.diagram.mermaid
%% ^^^^^^^^^^^ meta.declaration.alternative-path.diagram.mermaid
%% ^^ keyword.control.conditional.if.mermaid
%%    ^^^^^^^ string.unquoted.mermaid
    B-->A: Not so good :(
  else is well
%% ^^^^^^^^^^^^ meta.declaration.alternative-path.diagram.mermaid
%% ^^^ keyword.control.conditional.else.mermaid
%%     ^^^^^^^ meta.alternative-path.diagram.mermaid string.unquoted.mermaid
    B->A: Feeling fresh like a daisy
  end
%% <- meta.declaration.alternative-path.diagram.mermaid
%% ^^ keyword.control.conditional.end.mermaid
  opt Extra response
%% <- meta.declaration.optional-path.diagram.mermaid
%% ^ keyword.type.begin.optional-path.diagram.mermaid
%%     ^ string.text.optional-path.diagram.mermaid
    B->A: You, Alice?
  end
%% <- meta.declaration.optional-path.diagram.mermaid
%% ^ keyword.type.end.optional-path.diagram.mermaid
  Note right of C: Carol is the boss
  C->>A: Get back to work!
%% <- meta.declaration.message.diagram.mermaid
%% ^^^ keyword.operator.message.diagram.mermaid
%%     ^ punctuation.separator.key-value.mermaid
%%       ^^^^^^^^^^^^^^^^^ text.html.basic
  loop Every hour
    A->>B: Request 1
    activate B
%% <- meta.declaration.activation.diagram.mermaid
%%  ^ keyword.type.activation.diagram.mermaid
    A-x+B: Request 2
%% <- meta.declaration.message.diagram.mermaid
%%   ^^^ keyword.operator.message.diagram.mermaid
%%       ^ punctuation.separator.key-value.mermaid
%%         ^^^^^^^^^ text.html.basic
    B--x-A: Response 2
%% <- meta.declaration.message.diagram.mermaid
%%   ^^^^ keyword.operator.message.diagram.mermaid
%%        ^ punctuation.separator.key-value.mermaid
%%          ^^^^^^^^^^ text.html.basic
    B-->>A: Response 1<br />Next line
%% <- meta.declaration.message.diagram.mermaid
%%   ^^^^ keyword.operator.message.diagram.mermaid
%%        ^ punctuation.separator.key-value.mermaid
%%          ^^^^^^^^^^ text.html.basic
%%                    ^^^^^^ meta.tag.inline.any
    deactivate B
%% <- meta.declaration.activation.diagram.mermaid
%%  ^ keyword.type.activation.diagram.mermaid
  end

  Alice->>+John: Hello John, how are you?
%%^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ meta.declaration.message.diagram
%%^^^^^ variable.parameter
%%     ^^^^ keyword.operator.message.diagram
%%         ^^^^ variable.parameter
%%             ^ punctuation.separator.key-value
%%               ^^^^^^^^^^^^^^^^^^^^^^^^ text.html
  Note over Alice,John: A typical interaction<br/>But now in two lines
%% ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ meta.declaration.note.diagram.mermaid
%%^^^^ keyword.type.note.diagram.mermaid
%%     ^^^^ constant.language.note.diagram.mermaid
%%          ^^^^^ variable.parameter.mermaid
%%                ^^^^ variable.parameter
%%                    ^ punctuation.separator.key-value
%%                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ text.html.basic
%%                                           ^ meta.tag.inline.any.html punctuation.definition.tag.begin.html

  Alice->>+John: John, can you hear me?
  John-->>-Alice: Hi Alice, I can hear you!
  John-->>-Alice: I feel great!

  Alice --> John: Spaces between actors and arrows
%%^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ meta.declaration.message.diagram
%%^^^^^^ variable.parameter
%%      ^^^ keyword.operator.message.diagram
%%          ^^^^ variable.parameter
%%              ^ punctuation.separator.key-value
%%                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ text.html

sequenceDiagram
    Consumer-->API: Book something
    API-->BookingService: Start booking process
    break when the booking process fails
        API-->Consumer: show failure
    end
    API-->BillingService: Start billing process

sequenceDiagram
    participant Alice
    participant John

    rect rgb(191, 223, 255)
%%  ^^^^ meta.block keyword.context.block
%%       ^^^ meta.block meta.function-call.identifier support.function
%%          ^^^^^^^^^^^^^^^ meta.block meta.function-call.arguments
%%          ^ punctuation.section.parens.begin
%%           ^^^ meta.number.integer.decimal constant.numeric.value
%%              ^ punctuation.separator.sequence
%%                ^^^ meta.number.integer.decimal constant.numeric.value
%%                   ^ punctuation.separator.sequence
%%                     ^^^ meta.number.integer.decimal constant.numeric.value
%%                        ^ punctuation.section.parens.end
%%                         ^ - meta.function-call
      note right oF Alice: Alice calls John.
%%    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ meta.block meta.declaration.note.diagram
%%    ^^^^ keyword.type.note.diagram
%%         ^^^^^^^^ constant.language.note.diagram
      Alice->>+John: Hello John, how are you?
      rect rgb(200, 150, 255)
        Alice->>+John: John, can you hear me?
        John-->>-Alice: Hi Alice, I can hear you!
      end
      John-->>-Alice: I feel great!
    end
    Alice ->>+ John: Did you want to go to the game tonight?
    John -->>- Alice: Yeah! See you there.

    A->>B: I #9829; you!
    B->>A: I #9829; you #infin; times more!

    link Alice: Dashboard @ https://dashboard.contoso.com/alice
    link Alice: Wiki @ https://wiki.contoso.com/alice
    link John: Dashboard @ https://dashboard.contoso.com/john
    link John: Wiki @ https://wiki.contoso.com/john
    links Alice: {"Dashboard": "https://dashboard.contoso.com/alice", "Wiki": "https://wiki.contoso.com/alice"}
    links John: {"Dashboard": "https://dashboard.contoso.com/john", "Wiki": "https://wiki.contoso.com/john"}
